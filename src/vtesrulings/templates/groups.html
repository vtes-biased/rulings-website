{% extends "layout.html" %}

{% block scripts %}
<script async src="{{ url_for('static', filename='dist/js/groups.js') }}" type="module"></script>
{% endblock%}

{% block content %}
<div class="row my-2 mx-0">
    {% if current %}
    <div class="col-md" id="groupDisplay" data-uid="{{ current.uid }}">
        <h2 id="groupName">{{ current.name }}</h2>
        <div class="list-group">
            {% for card in current.cards %}
            <div class="list-group-item d-flex flex-wrap align-items-center" data-uid="{{ card.uid }}">
                <div class="px-2 me-auto">
                    <a href="/index.html?uid={{ card.uid }}" class="krcg-card" data-noclick="true"
                        data-uid="{{ card.uid }}">{{ card.name }}</a>
                </div>
                <div class="invisible px-2">
                    {% if loop.first %}
                    <div id="cardEditControls" class="btn-group">
                        <button type="button" data-bs-toggle="dropdown" aria-expanded="false"
                            class="btn badge btn-secondary btn-sm dropdown-toggle">Icon</button>
                        <ul class="dropdown-menu"><!-- Icons added by JS --></ul>
                    </div>
                    {% endif %}
                </div>
                <div class="krcg-prefix w-25 px-2">
                    {{ card.prefix | symbolreplace(card.symbols) | safe }}
                </div>
            </div>
            {% endfor %}
        </div>
        <h3 class="my-2">Rulings</h3>
        {% if current.rulings %}
        <div id="rulingsList" data-source="{{current.uid}}">
            {% for ruling in current.rulings %}
            <div class="card my-1 krcg-ruling" data-source="{{current.uid}}" data-ruling='{{ruling | tojson}}'>
                <!-- Content added by JS -->
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div id="rulingsList">No Ruling.</div>
        {% endif %}
    </div>
    {% else %}
    <div class="col-md"></div>
    {% endif %}
    <div class="col-md list-group p-0" id="groupsList">
        {% for group in groups %}
        {% if current and group.uid == current.uid %}
        <a href="?uid={{ group.uid }}"
            class="list-group-item list-group-item-action d-flex justify-content-between align-items-center active"
            data-uid="{{ group.uid }}">
            {{ group.name }}
            <span class="badge text-bg-primary rounded-pill">{{ group.cards | length}}</span>
        </a>
        {% else %}
        <a href="?uid={{ group.uid }}"
            class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
            data-uid="{{ group.uid }}">
            {{ group.name }}
            <span class="badge text-bg-primary rounded-pill">{{ group.cards | length}}</span>
        </a>
        {% endif %}
        {% endfor %}
    </div>
</div>
{% endblock %}